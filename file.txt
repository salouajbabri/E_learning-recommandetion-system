After investigation, it was found that the column NUM_ProjectKey in the table [DAL_EPV2_BI].[ETB].[DWH_TB_FactProgress] contains NULL values (refer to screenshot DalEPV2BI_FactProgress).
Reviewing the offload spot spot_epv2_bi in the dedicated environment revealed that the source table [spot_epv2_bi].[dbo].[dwh_tb_factprogress], which feeds data into the DAL_EPV2_BI database, has the NUM_ProjectKey column correctly populated with valid integer values (see screenshot SpotEPV2BI_FactProgress).
However, it was also observed that within the spot_epv2_bi, the NUM_ProjectKey column is defined as a computed column (see screenshot Spot_EPV2_BI_FactProgress_DataType), along with the columns NUM_CutOffKey and Partion_Date. These computed columns result in NULL values in the DAL_EPV2_BI database.
This behavior is explained by the fact that these columns serve as partition keys used for incremental offloads rather than full loads. The attached screenshot Tables_With_Inc_Load lists tables configured for incremental offloading along with their respective partition keys, which exhibit the same issue. In contrast, tables using full load mode, such as [DAL_EPV2_BI].[ETB].[DWH_TB_FactPreservationFuture], show valid values in the NUM_ProjectKey column instead of NULLs (see screenshot Table_With_Full_Load).
Further examination shows that all tables using incremental offloads have partition keys defined as computed columns in the spot_epv2_bi. Consequently, these keys are not physically stored in the data and appear as NULL in the DAL_EPV2_BI database (see screenshot Example_FactCertification.png for the table TB_FactCertification as an example).
This case is not considered an incident, as it has not been working correctly from the start after deployment, and all affected tables share this issue. It is recommended to raise a production bug or create a user story to address this problem for all impacted tables, not only TB_FactProgress.
Regards,
